{"version":3,"file":"js/609.11622858.js","mappings":"uZAuBA,MAAMA,EAAY,CAAC,OAAQ,OAAQ,QAAS,WACtCC,GAAY,IAAIC,MAAOC,UAEvBC,GAAQC,EAAAA,EAAAA,IAAS,CACrBC,YAAQC,EACRC,aAAc,EACdC,aAAc,EACdC,OAAO,EACPC,SAAS,IAGLC,EAAQC,EAgBRC,EAAYC,IAChB,GAAIX,EAAMO,UAAYP,EAAMM,YAA0BH,IAAjBH,EAAME,OAAsB,OACjEF,EAAMI,cAAe,IAAIN,MAAOC,UAAYF,EAC5C,MAAMe,EAAOZ,EAAMI,aAAeI,EAAMK,SAClCC,EAAOF,GAAQ,EAAI,EAAI,EAAIA,EAC3BG,EAAU,GAAKC,KAAKC,MAAM,GAAKH,GACrCd,EAAMK,aAAeU,EAAUA,EAAU,EACzCf,EAAME,OAASN,EAAUe,EAAM,EAGjC,IAAIO,EACAC,EAAY,EACZC,EAAiB,EACrB,MAAMC,EAAcA,UACGlB,IAAjBe,GACFI,aAAaJ,GAEflB,EAAMO,SAAWP,EAAMO,QAClBP,EAAMO,QAUTY,GAAY,IAAIrB,MAAOC,UAAYqB,GATnCA,GAAiB,IAAItB,MAAOC,UACxBS,EAAMe,MAAQJ,EAChBD,EAAeM,YAAW,KACxBC,GAAO,GACNjB,EAAMe,MAAQJ,GAEjBM,IAIJ,EAGF,IAAIC,EACAC,EAAe,EACfC,EAAoB,EACxB,MAAMH,EAAQA,KACZzB,EAAMM,OAAQ,OACUH,IAApBuB,GACFJ,aAAaI,GAEV1B,EAAMO,QAMToB,GAAe,IAAI7B,MAAOC,UAAY6B,GALtCA,GAAoB,IAAI9B,MAAOC,UAC/B2B,EAAkBF,YAAW,KAC3Bd,EAAS,EAAE,GACVF,EAAMK,SAAWc,GAGtB,E,OAGFE,EAAa,CACXnB,WACAW,gB,itBC/FF,MAAMS,GAA2B,OAAgB,EAAQ,CAAC,CAAC,YAAY,qBAEvE,O,6GCAA,MAAMP,EAAQ,E,+BAEd,MAAMQ,EAAe,GAErB,IAAIC,EAAU,GAEVC,EAAc,EAEdpC,EAAY,EAEZU,GAAU,EAEd,MAAM2B,EAAmBC,IACvBJ,EAAaK,KAAKD,EAAI,EAGlBE,EAAWA,KACX9B,EACFV,GAAY,IAAIC,MAAOC,UAEvBkC,GAAc,IAAInC,MAAOC,UAAYF,EAEvCU,GAAWA,EACXyB,EAAQM,SAAQC,IACdjB,aAAaiB,EAAG,IAElBP,EAAU,GACV,IAAK,IAAIQ,EAAI,EAAGA,EAAIT,EAAaU,OAAQD,IAEvC,GADAT,EAAaS,GAAGnB,eACXd,EAAS,CACZ,MAAMgC,EAAKf,YAAW,KACpBO,EAAaS,GAAG9B,SAAS,EAAI8B,EAAE,GAC9BjB,EAAQ,KAAQ,EAAIiB,GAAKP,GAC5BD,EAAQI,KAAKG,EACf,CACF,E,OAGFG,EAAAA,EAAAA,KAAU,S,8QC5CV,MAAMZ,EAAc,EAEpB,O","sources":["webpack://gutar/./src/page/guitar/tap-number.vue","webpack://gutar/./src/page/guitar/tap-number.vue?3ee0","webpack://gutar/./src/page/test/index.vue","webpack://gutar/./src/page/test/index.vue?f377"],"sourcesContent":["<template>\r\n  <div class=\"item\">\r\n    <div class=\"item-animation\">\r\n      <div v-if=\"state.start && state.result===undefined\"\r\n           class=\"item-circle\"\r\n           :class=\"state.isPause?'animation-pause':'animation-running'\"\r\n           :style=\"{ 'animation': `circle-close ${props.duration/1000}s linear` }\">\r\n      </div>\r\n      <div v-if=\"state.result!==undefined\"\r\n           :style=\"`width:${state.scoreBoxSize}px;height:${state.scoreBoxSize}px;margin-top:${1-state.scoreBoxSize/2}px`\"\r\n           class=\"item-result\"\r\n           :class=\"`item-result-${state.result}`\">\r\n        <span class=\"score-name\">{{ state.result }}</span>\r\n      </div>\r\n    </div>\r\n    <span style=\"display:block;width: 100%;\" :class=\"state.result!==undefined?`number-${state.result}`:''\">{{\r\n        value\r\n      }}</span>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport {defineProps, onMounted, reactive} from \"vue\";\r\n\r\nconst scoreName = ['miss', 'good', 'great', 'perfect']\r\nconst beginTime = new Date().getTime();\r\n\r\nconst state = reactive({\r\n  result: undefined,\r\n  continueTime: 0,\r\n  scoreBoxSize: 0,\r\n  start: false,\r\n  isPause: true\r\n});\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    required: true,\r\n    type: Number\r\n  },\r\n  duration: {\r\n    required: true,\r\n    type: Number\r\n  },\r\n  delay: {\r\n    required: false,\r\n    default: 0,\r\n    type: Number\r\n  }\r\n})\r\n\r\nconst setScore = (score) => {\r\n  if (state.isPause || !state.start || state.result !== undefined) return;\r\n  state.continueTime = new Date().getTime() - beginTime;\r\n  const rate = state.continueTime / props.duration;\r\n  const left = rate >= 1 ? 0 : 1 - rate;\r\n  const boxSize = 20 + Math.floor(20 * left);\r\n  state.scoreBoxSize = boxSize + boxSize % 2;\r\n  state.result = scoreName[score];\r\n}\r\n\r\nlet delayTimeOut;\r\nlet delayTime = 0;\r\nlet delayTimeStamp = 0;\r\nconst togglePause = () => {\r\n  if (delayTimeOut !== undefined) {\r\n    clearTimeout(delayTimeOut);\r\n  }\r\n  state.isPause = !state.isPause;\r\n  if (!state.isPause) {\r\n    delayTimeStamp = new Date().getTime();\r\n    if (props.delay > delayTime) {\r\n      delayTimeOut = setTimeout(() => {\r\n        begin();\r\n      }, props.delay - delayTime)\r\n    } else {\r\n      begin();\r\n    }\r\n  } else {\r\n    delayTime = new Date().getTime() - delayTimeStamp;\r\n  }\r\n}\r\n\r\nlet setScoreTimeOut;\r\nlet setScoreTime = 0;\r\nlet setScoreTimeStamp = 0;\r\nconst begin = () => {\r\n  state.start = true;\r\n  if (setScoreTimeOut !== undefined) {\r\n    clearTimeout(setScoreTimeOut);\r\n  }\r\n  if (!state.isPause) {\r\n    setScoreTimeStamp = new Date().getTime();\r\n    setScoreTimeOut = setTimeout(() => {\r\n      setScore(0);\r\n    }, props.duration - setScoreTime)\r\n  } else {\r\n    setScoreTime = new Date().getTime() - setScoreTimeStamp;\r\n  }\r\n}\r\n\r\ndefineExpose({\r\n  setScore,\r\n  togglePause\r\n})\r\n\r\n</script>\r\n<style lang=\"less\">\r\n@keyframes circle-close {\r\n  0% {\r\n    border: 1px solid #3f3f3f;\r\n    width: 40px;\r\n    height: 40px;\r\n    margin-top: -19px;\r\n  }\r\n  100% {\r\n    border: 1px solid #3f3f3f;\r\n    width: 20px;\r\n    height: 20px;\r\n    margin-top: -9px;\r\n  }\r\n}\r\n\r\n@keyframes score-show {\r\n  0% {\r\n    opacity: 100%;\r\n  }\r\n  100% {\r\n    opacity: 0;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"less\" scoped>\r\n.animation-running {\r\n  animation-play-state: running !important;\r\n}\r\n\r\n.animation-pause {\r\n  animation-play-state: paused !important;\r\n}\r\n\r\n.item {\r\n  width: 20px;\r\n  height: 2px;\r\n  margin: 10px 0;\r\n  text-align: center;\r\n  line-height: 2px;\r\n}\r\n\r\n.item-animation {\r\n  width: 100%;\r\n  height: 0;\r\n  padding: 0;\r\n  margin: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n\r\n  .item-circle {\r\n    border-radius: 100%;\r\n    align-items: center;\r\n    flex-shrink: 0;\r\n  }\r\n}\r\n\r\n.item-result {\r\n  opacity: 0;\r\n  border-radius: 100%;\r\n  animation: score-show 0.8s linear;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  flex-shrink: 0;\r\n\r\n  .score-name {\r\n    line-height: 12px;\r\n    color: white;\r\n    transform: scale(0.6);\r\n    margin-left: -3px;\r\n  }\r\n}\r\n\r\n.item-result-miss {\r\n  font-size: 12px;\r\n  background-color: #afb6b6;\r\n}\r\n\r\n.item-result-good {\r\n  font-size: 13px;\r\n  background-color: #c6ffff;\r\n}\r\n\r\n.item-result-great {\r\n  font-size: 14px;\r\n  background-color: #76ffff;\r\n}\r\n\r\n.item-result-perfect {\r\n  font-size: 12px;\r\n  background-color: #00ffff;\r\n}\r\n\r\n.number-miss {\r\n  color: #afb6b6;\r\n}\r\n\r\n.number-good {\r\n  color: #008bda;\r\n}\r\n\r\n.number-great {\r\n  color: #008bda;\r\n}\r\n\r\n.number-perfect {\r\n  color: #008bda;\r\n}\r\n</style>\r\n","import script from \"./tap-number.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./tap-number.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./tap-number.vue?vue&type=style&index=0&id=3e3fe5ee&lang=less\"\nimport \"./tap-number.vue?vue&type=style&index=1&id=3e3fe5ee&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3e3fe5ee\"]])\n\nexport default __exports__","<template>\r\n  <div style=\"width: 40px;display: flex;flex-wrap: wrap;padding: 20px\" @click=\"doAction\">\r\n    <TapNumber v-for=\"i in 4\" :value=\"i\" :duration=\"1000\" :ref=\"el => setTapNumberRef(el)\" :delay=\"delay\"></TapNumber>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport TapNumber from \"@/page/guitar/tap-number\";\r\nimport {onMounted} from \"vue\";\r\n\r\nconst delay = 0;\r\n\r\nconst tapNumberRef = [];\r\n\r\nlet timeOut = [];\r\n\r\nlet runningTime = 0;\r\n\r\nlet beginTime = 0;\r\n\r\nlet isPause = true;\r\n\r\nconst setTapNumberRef = (ref) => {\r\n  tapNumberRef.push(ref)\r\n}\r\n\r\nconst doAction = () => {\r\n  if (isPause) {\r\n    beginTime = new Date().getTime();\r\n  } else {\r\n    runningTime = new Date().getTime() - beginTime;\r\n  }\r\n  isPause = !isPause;\r\n  timeOut.forEach(to => {\r\n    clearTimeout(to);\r\n  });\r\n  timeOut = [];\r\n  for (let i = 0; i < tapNumberRef.length; i++) {\r\n    tapNumberRef[i].togglePause();\r\n    if (!isPause) {\r\n      const to = setTimeout(() => {\r\n        tapNumberRef[i].setScore(3 - i);\r\n      }, delay + 1000 / (4 - i) - runningTime);\r\n      timeOut.push(to);\r\n    }\r\n  }\r\n}\r\n\r\nonMounted(() => {\r\n\r\n})\r\n</script>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["scoreName","beginTime","Date","getTime","state","reactive","result","undefined","continueTime","scoreBoxSize","start","isPause","props","__props","setScore","score","rate","duration","left","boxSize","Math","floor","delayTimeOut","delayTime","delayTimeStamp","togglePause","clearTimeout","delay","setTimeout","begin","setScoreTimeOut","setScoreTime","setScoreTimeStamp","__expose","__exports__","tapNumberRef","timeOut","runningTime","setTapNumberRef","ref","push","doAction","forEach","to","i","length","onMounted"],"sourceRoot":""}