(self["webpackChunkgutar"]=self["webpackChunkgutar"]||[]).push([[719],{958:function(e){e.exports={chordMap:{C:[{fret:1,string:2,finger:1},{fret:2,string:4,finger:2},{fret:3,string:5,finger:3}],D:[{fret:2,string:1,finger:1},{fret:2,string:3,finger:2},{fret:3,string:2,finger:3}],E:[{fret:1,string:3,finger:1},{fret:2,string:4,finger:2},{fret:2,string:5,finger:3}],F:[{fret:1,string:1,finger:1},{fret:1,string:2,finger:1},{fret:1,string:6,finger:1},{fret:2,string:3,finger:2},{fret:3,string:5,finger:3},{fret:3,string:4,finger:3}],G:[{fret:2,string:5,finger:2},{fret:3,string:6,finger:3},{fret:3,string:1,finger:4}],A:[{fret:2,string:4,finger:2},{fret:2,string:3,finger:3},{fret:2,string:2,finger:4}],B:[{fret:2,string:1,finger:1},{fret:2,string:5,finger:1},{fret:2,string:6,finger:1},{fret:4,string:2,finger:2},{fret:4,string:3,finger:3},{fret:4,string:4,finger:4}],Am:[{fret:1,string:2,finger:1},{fret:2,string:3,finger:2},{fret:2,string:4,finger:3}],Dm:[{fret:2,string:1,finger:1},{fret:2,string:3,finger:2},{fret:3,string:2,finger:3}],Em:[{fret:2,string:4,finger:1},{fret:2,string:5,finger:2}]},enabledChord:["C","D","E","F","G","A","B","Am","Dm","Em"],pitchNames:[[{number:3,topDot:1},{number:4,topDot:1},{number:4,topDot:1,half:1},{number:5,topDot:1}],[{number:7},{number:1,topDot:1},{number:1,topDot:1,half:1},{number:2,half:1}],[{number:5},{number:5,half:1},{number:6},{number:6,half:1}],[{number:2},{number:2,half:1},{number:3},{number:4}],[{number:6,bottomDot:1},{number:6,bottomDot:1,half:1},{number:7,bottomDot:1},{number:1}],[{number:3,bottomDot:1},{number:4,bottomDot:1},{number:4,bottomDot:1,half:1},{number:5,bottomDot:1}]]}},1719:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return be}});var i=r(6768),n=r(4232),a=r(144),s=(r(4114),r(958)),o=r.n(s);let l=0;const c=e=>(l++,void 0===e&&(e="NoteItem"),`${e}_${l}`),u=({barLength:e,barBeat:t,beatNote:r,minBeatNote:i,maxFret:n,noteRate:a})=>{let s=[];for(let l=0;l<e;l++){let e=[],l=t*r,u=0,m=t*r/i,g=0,k=0;while(u<m){const t=u*i;if(g>t)t%r===0?e.push(-1):e.push(0);else{let t=f(a);t<=l?l-=t:(t=l,l=0),e.push(t),k+=1,g+=t}u++}let b=d(k,n);const v=c("barKey");let p={_key:v,noteList:[]},h=0;for(let t=0;t<e.length;t++){let r=e[t];const i=c("noteItem");if(r>0){let e=b[h],t=o().pitchNames[e.string-1][e.fret];p.noteList.push({_key:i,note:r,...e,...t}),h++}else p.noteList.push({_key:i,note:r})}s.push(p)}return s},d=(e,t)=>{let r,i=[],n=o().enabledChord.length,a=0;for(let s=0;s<e;s++){let l=!1;if(a<1){let c=(0===s||Math.random()>.5)&&e-s>1;if(c){let e=Math.floor(Math.random()*n);l=!0,r=o().enabledChord[e];let t=o().chordMap[r].length;a=2+Math.floor(Math.random()*(t-1))}else i.push({fret:Math.floor(Math.random()*(t+1)),string:Math.ceil(6*Math.random())})}if(a>0){let e=o().chordMap[r],t=o().chordMap[r].length,n=Math.floor(Math.random()*t),s=e[n];i.push({beginChord:l,chordName:r,fret:s.fret,string:s.string}),a--}}return i},f=e=>{let t=0,r=0;for(let n=0;n<e.length;n++){let i=e[n]*Math.random();i>r&&(r=i,t=n)}let i=1/(1<<t);return i};var m={getRandomBarArr:u};const g=e=>((0,i.Qi)("data-v-2eb72a0d"),e=e(),(0,i.jt)(),e),k={class:"chord-box"},b={class:"chord-name"},v={class:"chord-content"},p=g((()=>(0,i.Lk)("div",{class:"chord-sign"},null,-1))),h={class:"chord-table"},L={class:"chord-fret"},S={key:0,class:"string-dot"};var T={__name:"chord",props:{name:{required:!0,type:String}},setup(e){const t=(0,a.Kh)({maxFret:3,fretInfo:{}}),r=e,o=()=>{const e=s.chordMap[r.name];if(void 0===e)return;let i={},n=0;for(let t=0;t<e.length;t++){const r=e[t].fret;n=r>n?r:n;const a=e[t].string,s=e[t].finger;void 0===i[r]&&(i[r]={}),i[r][a]=s}t.maxFret=n<3?3:n,t.fretInfo=i};return o(),(r,a)=>((0,i.uX)(),(0,i.CE)("div",k,[(0,i.Lk)("div",b,(0,n.v_)(e.name),1),(0,i.Lk)("div",v,[p,(0,i.Lk)("div",h,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.maxFret,(e=>((0,i.uX)(),(0,i.CE)("div",L,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(6,(r=>(0,i.Lk)("div",{class:(0,n.C4)(["chord-string",6===r?"chord-string-last":""])},[t.fretInfo[e]&&void 0!==t.fretInfo[e][7-r]?((0,i.uX)(),(0,i.CE)("div",S)):(0,i.Q3)("",!0)],2))),64))])))),256))])])]))}},N=r(1241);const x=(0,N.A)(T,[["__scopeId","data-v-2eb72a0d"]]);var y=x;const C={class:"item"},I={class:"item-animation"},_={class:"score-name"};var B={__name:"tap-number",props:{value:{required:!0,type:Number},duration:{required:!0,type:Number},itemKey:{required:!0,type:String}},setup(e,{expose:t}){const r=["miss","good","great","perfect"],s=(new Date).getTime(),o=(0,a.Kh)({result:void 0,continueTime:0,scoreBoxSize:0,isPause:!0,start:!1});let l=()=>{};const c=e,u=e=>{if(o.isPause||void 0!==o.result)return;o.continueTime=(new Date).getTime()-s;const t=o.continueTime/c.duration,i=t>=1?0:1-t,n=20+Math.floor(20*i);o.scoreBoxSize=n+n%2,o.result=r[e],l()};let d,f=0,m=0;const g=()=>{o.start=!0,o.isPause&&(o.isPause=!1,m=(new Date).getTime(),d=setTimeout((()=>{u(0)}),c.duration-f))},k=()=>{o.isPause||(o.isPause=!0,void 0!==d&&clearTimeout(d),f=(new Date).getTime()-m)},b=()=>{o.isPause?g():k()},v=()=>!o.isPause,p=e=>{l=e},h=()=>c.itemKey;return t({setScore:u,isRunning:v,run:g,pause:k,togglePause:b,setEndMethod:p,getItemKey:h}),(t,r)=>((0,i.uX)(),(0,i.CE)("div",C,[(0,i.Lk)("div",I,[o.start&&void 0===o.result?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,n.C4)(["item-circle",o.isPause?"animation-pause":"animation-running"]),style:(0,n.Tr)({animation:`circle-close ${c.duration/1e3}s linear`})},null,6)):(0,i.Q3)("",!0),void 0!==o.result?((0,i.uX)(),(0,i.CE)("div",{key:1,style:(0,n.Tr)(`width:${o.scoreBoxSize}px;height:${o.scoreBoxSize}px;margin-top:${1-o.scoreBoxSize/2}px`),class:(0,n.C4)(["item-result",`item-result-${o.result}`])},[(0,i.Lk)("span",_,(0,n.v_)(o.result),1)],6)):(0,i.Q3)("",!0)]),(0,i.Lk)("span",{class:(0,n.C4)(void 0!==o.result?`number-${o.result}`:"")},(0,n.v_)(e.value),3)]))}};const E=(0,N.A)(B,[["__scopeId","data-v-7f44a16a"]]);var O=E;const M=e=>((0,i.Qi)("data-v-1ef35160"),e=e(),(0,i.jt)(),e),z={class:"bar-line"},X={class:"chord-line"},D=M((()=>(0,i.Lk)("div",{class:"note-item"},null,-1))),K={class:"note-item"},R={key:0,class:"chord-box"},F={class:"bar-content"},w=M((()=>(0,i.Lk)("div",{class:"bar-start"},[(0,i.Lk)("div",{class:"bar-start-top"}),(0,i.Lk)("div",{class:"bar-start-center"}),(0,i.Lk)("div",{class:"bar-start-bottom"})],-1))),A={class:"string-line"},P={class:"note-item"},$=M((()=>(0,i.Lk)("div",{class:"note-tab"},[(0,i.Lk)("span",{class:"note-tab-text"},"T"),(0,i.Lk)("span",{class:"note-tab-text"},"A"),(0,i.Lk)("span",{class:"note-tab-text"},"B")],-1))),Q={class:"note-string"},q=["id"],j={key:0,class:"note-tab note-tab-end"},H={class:"note-string"},W={class:"number-line"},G=M((()=>(0,i.Lk)("div",{class:"note-item"},null,-1))),V={class:"note-item"},J={class:"number-box"},U={class:"note-number"};var Y={__name:"bar",props:{item:{required:!0},speed:{required:!0,type:Number}},setup(e,{expose:t}){const r=e,s={},o=(e,t)=>{s[e]=t},l=e=>s[e];return t({getTapNumber:l}),(e,t)=>((0,i.uX)(),(0,i.CE)("div",z,[(0,i.Lk)("div",X,[D,((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.item.noteList,(e=>((0,i.uX)(),(0,i.CE)("div",K,[e.beginChord?((0,i.uX)(),(0,i.CE)("div",R,[(0,i.bF)(y,{name:e.chordName},null,8,["name"])])):(0,i.Q3)("",!0)])))),256))]),(0,i.Lk)("div",F,[w,(0,i.Lk)("div",null,[(0,i.Lk)("div",A,[(0,i.Lk)("div",P,[(0,i.Lk)("div",null,[$,((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(6,(e=>(0,i.Lk)("div",Q))),64))])]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.item.noteList,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:e._key,class:"note-item",id:e._key},[t===r.item.noteList.length-1?((0,i.uX)(),(0,i.CE)("div",j)):(0,i.Q3)("",!0),((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(6,(n=>(0,i.Lk)("div",H,[e.string===n?((0,i.uX)(),(0,i.Wv)((0,a.R1)(O),{key:0,duration:6e4/r.speed,value:e.fret,itemKey:e._key,ref_for:!0,ref:e=>o(t,e)},null,8,["duration","value","itemKey"])):(0,i.Q3)("",!0)]))),64))],8,q)))),128))]),(0,i.Lk)("div",W,[G,((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.item.noteList,(e=>((0,i.uX)(),(0,i.CE)("div",V,[(0,i.Lk)("div",J,[(0,i.Lk)("div",{class:(0,n.C4)(["number-dot",e.topDot?"number-dot-show":""])},null,2),(0,i.Lk)("div",{class:(0,n.C4)(["number-half",e.half?"number-half-show":""])},[(0,i.Lk)("span",U,(0,n.v_)(e.number),1)],2),(0,i.Lk)("div",{class:(0,n.C4)(["number-dot",e.bottomDot?"number-dot-show":""])},null,2)])])))),256))])])])]))}};const Z=(0,N.A)(Y,[["__scopeId","data-v-1ef35160"]]);var ee=Z;const te=e=>((0,i.Qi)("data-v-c2cc5046"),e=e(),(0,i.jt)(),e),re={style:{height:"100%",padding:"0 10px"}},ie={style:{display:"flex","flex-direction":"column",height:"100%"}},ne={class:"page-head"},ae={class:"page-title"},se={class:"page-info"},oe={class:"page-info-line"},le={class:"page-info-line"},ce=te((()=>(0,i.Lk)("div",{class:"page-info-line"},"Capo = 1",-1))),ue={class:"note-page"},de={class:"bar-group"},fe={class:"bar-group"},me=te((()=>(0,i.Lk)("div",{style:{width:"100%"}},[(0,i.Lk)("div",{style:{"background-color":"white",height:"10vh",width:"100%"}})],-1)));var ge={__name:"index",setup(e){const t=(0,a.KR)(),r=(0,a.Kh)({ready:!1,title:"EMO",speed:60,barBeat:4,beatNote:1/4,minBeatNote:1/8,noteRate:[2,2,6,3],maxFret:3,barStack0:[],barStack1:[]}),s={intervalRunTime:0,interval:void 0,barLength:10,intervalTime:5,barRef0:{},barRef1:{},runningTapNum:{}},o=(e,t)=>{s.barRef0[e]=t},l=(e,t)=>{s.barRef1[e]=t},c=()=>{let e=m.getRandomBarArr({barLength:s.barLength,barBeat:r.barBeat,beatNote:r.beatNote,minBeatNote:r.minBeatNote,maxFret:r.maxFret,noteRate:r.noteRate});1===g.stackIndex&&(r.barStack0=e),0===g.stackIndex&&(r.barStack1=e)},u=()=>{r.ready&&g.tickOfStack!==g.barTickSize||c()},d=()=>{if(g.tickIndex<g.barTickSize)return;const e=t.value.children[0],r=t.value.children[1],i=g.tickOfStack>=g.barTickSize?g.tickOfStack-g.barTickSize:(s.barLength-1)*g.barTickSize+g.tickOfStack,n=g.stackTickSize,a=0===g.stackIndex&&0===g.barOfStack||1===g.stackIndex&&g.barOfStack>0;if(a){let a=e.clientHeight+r.clientHeight-t.value.clientHeight,s=r.clientHeight*i/n-a;e.style=`margin-bottom:${s}px`,t.value.style="flex-direction: column-reverse;"}else{let r=-e.clientHeight*i/n;e.style=`margin-top:${r}px`,t.value.style="flex-direction: column;"}},f=()=>{if(1===g.tickOfMinNote){const e=0===g.stackIndex?s.barRef0[g.barOfStack]?.getTapNumber(g.minNoteOfBar):s.barRef1[g.barOfStack]?.getTapNumber(g.minNoteOfBar);if(e&&!e.isRunning()){e.run();const t=e.getItemKey();s.runningTapNum[t]=e,e.setEndMethod((()=>{delete s.runningTapNum[t]}))}}},g={ready:!1,tickIndex:-1,tickOfMinNote:-1,tickOfBar:-1,tickOfStack:-1,minNoteTickSize:-1,barTickSize:-1,stackTickSize:-1,barMinNoteSize:-1,barOfStack:-1,minNoteOfBar:-1,stackIndex:1},k=()=>{if(g.tickIndex+=1,!g.ready){const e=6e4/r.speed/r.beatNote*r.minBeatNote;g.minNoteTickSize=e/s.intervalTime,g.barTickSize=g.minNoteTickSize*r.barBeat*r.beatNote/r.minBeatNote,g.barMinNoteSize=g.barTickSize/g.minNoteTickSize,g.stackTickSize=g.barTickSize*s.barLength,g.ready=!0}g.tickOfMinNote=g.tickIndex%g.minNoteTickSize,g.tickOfBar=g.tickIndex%g.barTickSize,g.tickOfStack=g.tickIndex%g.stackTickSize,0===g.tickOfStack?(g.barOfStack=0,g.stackIndex=1-g.stackIndex):0===g.tickOfBar&&(g.barOfStack+=1),0===g.tickOfBar?g.minNoteOfBar=0:0===g.tickOfMinNote&&(g.minNoteOfBar+=1)},b=()=>{if(void 0!==s.interval)return clearInterval(s.interval),s.interval=void 0,void Object.keys(s.runningTapNum).forEach((e=>{s.runningTapNum[e].pause()}));Object.keys(s.runningTapNum).forEach((e=>{s.runningTapNum[e].run()})),s.interval=setInterval((()=>{v(),s.intervalRunTime+=s.intervalTime}),s.intervalTime)},v=()=>{k(),u(),d(),f()};return(0,i.sV)((()=>{c(),v(),r.ready=!0})),(e,s)=>((0,i.uX)(),(0,i.CE)("div",re,[(0,i.Lk)("div",ie,[(0,i.Lk)("div",null,[(0,i.Lk)("div",ne,[(0,i.Lk)("div",ae,(0,n.v_)(r.title),1),(0,i.Lk)("div",se,[(0,i.Lk)("div",oe,"1 = C "+(0,n.v_)(r.barBeat)+"/"+(0,n.v_)(Math.floor(1/r.beatNote)),1),(0,i.Lk)("div",le,"♪ = "+(0,n.v_)(r.speed),1),ce])])]),(0,i.Lk)("div",ue,[(0,i.Lk)("div",{class:"note-table",ref_key:"noteTable",ref:t,onClick:b},[(0,i.Lk)("div",de,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.barStack0,((e,t)=>((0,i.uX)(),(0,i.Wv)((0,a.R1)(ee),{item:e,speed:r.speed,ref_for:!0,ref:e=>o(t,e)},null,8,["item","speed"])))),256))]),(0,i.Lk)("div",fe,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.barStack1,((e,t)=>((0,i.uX)(),(0,i.Wv)((0,a.R1)(ee),{item:e,speed:r.speed,ref_for:!0,ref:e=>l(t,e)},null,8,["item","speed"])))),256))])],512)]),me])]))}};const ke=(0,N.A)(ge,[["__scopeId","data-v-c2cc5046"]]);var be=ke}}]);
//# sourceMappingURL=719.3b345f21.js.map