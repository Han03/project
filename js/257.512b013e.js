(self["webpackChunkgutar"]=self["webpackChunkgutar"]||[]).push([[257],{958:function(e){e.exports={chordMap:{C:[{fret:1,string:2,finger:1},{fret:2,string:4,finger:2},{fret:3,string:5,finger:3}],D:[{fret:2,string:1,finger:1},{fret:2,string:3,finger:2},{fret:3,string:2,finger:3}],E:[{fret:1,string:3,finger:1},{fret:2,string:4,finger:2},{fret:2,string:5,finger:3}],F:[{fret:1,string:1,finger:1},{fret:1,string:2,finger:1},{fret:1,string:6,finger:1},{fret:2,string:3,finger:2},{fret:3,string:5,finger:3},{fret:3,string:4,finger:3}],G:[{fret:2,string:5,finger:2},{fret:3,string:6,finger:3},{fret:3,string:1,finger:4}],A:[{fret:2,string:4,finger:2},{fret:2,string:3,finger:3},{fret:2,string:2,finger:4}],B:[{fret:2,string:1,finger:1},{fret:2,string:5,finger:1},{fret:2,string:6,finger:1},{fret:4,string:2,finger:2},{fret:4,string:3,finger:3},{fret:4,string:4,finger:4}],Am:[{fret:1,string:2,finger:1},{fret:2,string:3,finger:2},{fret:2,string:4,finger:3}],Dm:[{fret:2,string:1,finger:1},{fret:2,string:3,finger:2},{fret:3,string:2,finger:3}],Em:[{fret:2,string:4,finger:1},{fret:2,string:5,finger:2}]},enabledChord:["C","D","E","F","G","A","B","Am","Dm","Em"],pitchNames:[[{number:3,topDot:1},{number:4,topDot:1},{number:4,topDot:1,half:1},{number:5,topDot:1}],[{number:7},{number:1,topDot:1},{number:1,topDot:1,half:1},{number:2,half:1}],[{number:5},{number:5,half:1},{number:6},{number:6,half:1}],[{number:2},{number:2,half:1},{number:3},{number:4}],[{number:6,bottomDot:1},{number:6,bottomDot:1,half:1},{number:7,bottomDot:1},{number:1}],[{number:3,bottomDot:1},{number:4,bottomDot:1},{number:4,bottomDot:1,half:1},{number:5,bottomDot:1}]]}},257:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return ae}});r(4114);var i=r(6768),n=r(4232),a=r(144),s=r(958),o=r.n(s);const l=e=>((0,i.Qi)("data-v-2eb72a0d"),e=e(),(0,i.jt)(),e),c={class:"chord-box"},d={class:"chord-name"},u={class:"chord-content"},f=l((()=>(0,i.Lk)("div",{class:"chord-sign"},null,-1))),m={class:"chord-table"},b={class:"chord-fret"},g={key:0,class:"string-dot"};var k={__name:"chord",props:{name:{required:!0,type:String}},setup(e){const t=(0,a.Kh)({maxFret:3,fretInfo:{}}),r=e,o=()=>{const e=s.chordMap[r.name];if(void 0===e)return;let i={},n=0;for(let t=0;t<e.length;t++){const r=e[t].fret;n=r>n?r:n;const a=e[t].string,s=e[t].finger;void 0===i[r]&&(i[r]={}),i[r][a]=s}t.maxFret=n<3?3:n,t.fretInfo=i};return o(),(r,a)=>((0,i.uX)(),(0,i.CE)("div",c,[(0,i.Lk)("div",d,(0,n.v_)(e.name),1),(0,i.Lk)("div",u,[f,(0,i.Lk)("div",m,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.maxFret,(e=>((0,i.uX)(),(0,i.CE)("div",b,[((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(6,(r=>(0,i.Lk)("div",{class:(0,n.C4)(["chord-string",6===r?"chord-string-last":""])},[t.fretInfo[e]&&void 0!==t.fretInfo[e][7-r]?((0,i.uX)(),(0,i.CE)("div",g)):(0,i.Q3)("",!0)],2))),64))])))),256))])])]))}},v=r(1241);const h=(0,v.A)(k,[["__scopeId","data-v-2eb72a0d"]]);var p=h;const L={class:"item"},S={class:"item-animation"},T={class:"score-name"};var x={__name:"tap-number",props:{value:{required:!0,type:Number},duration:{required:!0,type:Number},delay:{required:!1,default:0,type:Number}},setup(e,{expose:t}){const r=["miss","good","great","perfect"],s=(new Date).getTime(),o=(0,a.Kh)({result:void 0,continueTime:0,scoreBoxSize:0,start:!1,isPause:!0}),l=e,c=e=>{if(o.isPause||!o.start||void 0!==o.result)return;o.continueTime=(new Date).getTime()-s;const t=o.continueTime/l.duration,i=t>=1?0:1-t,n=20+Math.floor(20*i);o.scoreBoxSize=n+n%2,o.result=r[e]};let d,u=0,f=0;const m=()=>{o.start=!0,void 0!==d&&clearTimeout(d),o.isPause?u=(new Date).getTime()-f:(f=(new Date).getTime(),d=setTimeout((()=>{c(0)}),l.duration-u))};let b,g=0,k=0;const v=()=>{o.isPause&&(o.isPause=!1,k=(new Date).getTime(),l.delay>g?b=setTimeout((()=>{m()}),l.delay-g):m())},h=()=>{o.isPause||(o.isPause=!0,void 0!==b&&clearTimeout(b),g=(new Date).getTime()-k)},p=()=>{o.isPause?v():h()},x=()=>!o.isPause;return t({setScore:c,isRunning:x,run:v,pause:h,togglePause:p}),(t,r)=>((0,i.uX)(),(0,i.CE)("div",L,[(0,i.Lk)("div",S,[o.start&&void 0===o.result?((0,i.uX)(),(0,i.CE)("div",{key:0,class:(0,n.C4)(["item-circle",o.isPause?"animation-pause":"animation-running"]),style:(0,n.Tr)({animation:`circle-close ${l.duration/1e3}s linear`})},null,6)):(0,i.Q3)("",!0),void 0!==o.result?((0,i.uX)(),(0,i.CE)("div",{key:1,style:(0,n.Tr)(`width:${o.scoreBoxSize}px;height:${o.scoreBoxSize}px;margin-top:${1-o.scoreBoxSize/2}px`),class:(0,n.C4)(["item-result",`item-result-${o.result}`])},[(0,i.Lk)("span",T,(0,n.v_)(o.result),1)],6)):(0,i.Q3)("",!0)]),(0,i.Lk)("span",{style:{display:"block",width:"100%"},class:(0,n.C4)(void 0!==o.result?`number-${o.result}`:"")},(0,n.v_)(e.value),3)]))}};const C=(0,v.A)(x,[["__scopeId","data-v-508a7bdd"]]);var N=C;const y=e=>((0,i.Qi)("data-v-47bba5cc"),e=e(),(0,i.jt)(),e),I={class:"bar-line"},_={class:"chord-line"},O=y((()=>(0,i.Lk)("div",{class:"note-item"},null,-1))),z={class:"note-item"},B={key:0,class:"chord-box"},E={class:"bar-content"},D=y((()=>(0,i.Lk)("div",{class:"bar-start"},[(0,i.Lk)("div",{class:"bar-start-top"}),(0,i.Lk)("div",{class:"bar-start-center"}),(0,i.Lk)("div",{class:"bar-start-bottom"})],-1))),X={class:"string-line"},M={class:"note-item"},w=y((()=>(0,i.Lk)("div",{class:"note-tab"},[(0,i.Lk)("span",{class:"note-tab-text"},"T"),(0,i.Lk)("span",{class:"note-tab-text"},"A"),(0,i.Lk)("span",{class:"note-tab-text"},"B")],-1))),R={class:"note-string"},F={class:"note-item"},K={key:0,class:"note-tab note-tab-end"},P={class:"note-string"},$={class:"number-line"},A=y((()=>(0,i.Lk)("div",{class:"note-item"},null,-1))),Q={class:"note-item"},q={class:"number-box"},H={class:"note-number"};var j={__name:"bar",props:{item:{required:!0},speed:{required:!0,type:Number}},setup(e,{expose:t}){const r=e,s={},o=(e,t)=>{s[e]=t},l=e=>s[e];return t({getTapNumber:l}),(e,t)=>((0,i.uX)(),(0,i.CE)("div",I,[(0,i.Lk)("div",_,[O,((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.item.noteList,(e=>((0,i.uX)(),(0,i.CE)("div",z,[e.beginChord?((0,i.uX)(),(0,i.CE)("div",B,[(0,i.bF)(p,{name:e.chordName},null,8,["name"])])):(0,i.Q3)("",!0)])))),256))]),(0,i.Lk)("div",E,[D,(0,i.Lk)("div",null,[(0,i.Lk)("div",X,[(0,i.Lk)("div",M,[(0,i.Lk)("div",null,[w,((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(6,(e=>(0,i.Lk)("div",R))),64))])]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.item.noteList,((e,t)=>((0,i.uX)(),(0,i.CE)("div",F,[t===r.item.noteList.length-1?((0,i.uX)(),(0,i.CE)("div",K)):(0,i.Q3)("",!0),((0,i.uX)(),(0,i.CE)(i.FK,null,(0,i.pI)(6,(n=>(0,i.Lk)("div",P,[e.string===n?((0,i.uX)(),(0,i.Wv)((0,a.R1)(N),{key:0,duration:6e4/r.speed,value:e.fret,ref_for:!0,ref:e=>o(t,e)},null,8,["duration","value"])):(0,i.Q3)("",!0)]))),64))])))),256))]),(0,i.Lk)("div",$,[A,((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.item.noteList,(e=>((0,i.uX)(),(0,i.CE)("div",Q,[(0,i.Lk)("div",q,[(0,i.Lk)("div",{class:(0,n.C4)(["number-dot",e.topDot?"number-dot-show":""])},null,2),(0,i.Lk)("div",{class:(0,n.C4)(["number-half",e.half?"number-half-show":""])},[(0,i.Lk)("span",H,(0,n.v_)(e.number),1)],2),(0,i.Lk)("div",{class:(0,n.C4)(["number-dot",e.bottomDot?"number-dot-show":""])},null,2)])])))),256))])])])]))}};const W=(0,v.A)(j,[["__scopeId","data-v-47bba5cc"]]);var G=W;const V=e=>((0,i.Qi)("data-v-86269e4c"),e=e(),(0,i.jt)(),e),J={style:{width:"100%",height:"100%"}},U={style:{display:"flex","flex-direction":"column",height:"100%"}},Y=V((()=>(0,i.Lk)("div",{style:{width:"100%"}},[(0,i.Lk)("div",{style:{"background-color":"white",height:"10vh",width:"100%"}})],-1))),Z={class:"note-page"},ee={class:"bar-group"},te={class:"bar-group"},re=V((()=>(0,i.Lk)("div",{style:{width:"100%"}},[(0,i.Lk)("div",{style:{"background-color":"white",height:"10vh",width:"100%"}})],-1)));var ie={__name:"index",setup(e){const t=(0,a.KR)(),r=(0,a.Kh)({ready:!1,speed:60,barBeat:4,beatNote:1/4,minBeatNote:1/8,noteRate:[2,2,6,3],maxFret:3,barStack0:[],barStack1:[],orderRevert:!1}),s={intervalRunTime:0,interval:void 0,barLength:2,intervalTime:10,barRef0:{},barRef1:{}},l=(e,t)=>{s.barRef0[e]=t},c=(e,t)=>{s.barRef1[e]=t};let d=0;const u=e=>(d++,void 0===e&&(e="NoteItem"),`${e}_${d}`),f=()=>{let e=[];for(let t=0;t<s.barLength;t++){let t=[],i=r.barBeat*r.beatNote,n=0,a=r.barBeat*r.beatNote/r.minBeatNote,s=0,l=0;while(n<a){const e=n*r.minBeatNote;if(s>e)e%r.beatNote===0?t.push(-1):t.push(0);else{let e=b();e<=i?i-=e:(e=i,i=0),t.push(e),l+=1,s+=e}n++}let c=m(l);const d=u("barKey");let f={_key:d,noteList:[]},g=0;for(let e=0;e<t.length;e++){let r=t[e];const i=u("noteItem");if(r>0){let e=c[g],t=o().pitchNames[e.string-1][e.fret];f.noteList.push({_key:i,note:r,...e,...t}),g++}else f.noteList.push({_key:i,note:r})}e.push(f)}1===h.stackIndex&&(r.barStack0=e),0===h.stackIndex&&(r.barStack1=e)},m=e=>{let t,i=[],n=o().enabledChord.length,a=0;for(let s=0;s<e;s++){let l=!1;if(a<1){let c=(0===s||Math.random()>.5)&&e-s>1;if(c){let e=Math.floor(Math.random()*n);l=!0,t=o().enabledChord[e];let r=o().chordMap[t].length;a=2+Math.floor(Math.random()*(r-1))}else i.push({fret:Math.floor(Math.random()*(r.maxFret+1)),string:Math.ceil(6*Math.random())})}if(a>0){let e=o().chordMap[t],r=o().chordMap[t].length,n=Math.floor(Math.random()*r),s=e[n];i.push({beginChord:l,chordName:t,fret:s.fret,string:s.string}),a--}}return i},b=()=>{let e=0,t=0;for(let n=0;n<r.noteRate.length;n++){let i=r.noteRate[n]*Math.random();i>t&&(t=i,e=n)}let i=1/(1<<e);return i},g=()=>{r.ready&&h.tickOfStack!==h.barTickSize||f()},k=()=>{if(h.tickIndex<h.barTickSize)return;const e=t.value.children[0],i=t.value.children[1],n=h.tickOfStack>=h.barTickSize?h.tickOfStack-h.barTickSize:(s.barLength-1)*h.barTickSize+h.tickOfStack,a=h.stackTickSize,o=0===h.stackIndex&&0===h.barOfStack||1===h.stackIndex&&h.barOfStack>0;if(r.orderRevert!==o&&(r.orderRevert=o),o){let r=e.clientHeight+i.clientHeight-t.value.clientHeight,s=i.clientHeight*n/a-r;e.style=`margin-bottom:${s}px`}else{let t=-e.clientHeight*n/a;e.style=`margin-top:${t}px`}},v=()=>{if(1===h.tickOfMinNote){const e=0===h.stackIndex?s.barRef0[h.barOfStack]?.getTapNumber(h.minNoteOfBar):s.barRef1[h.barOfStack]?.getTapNumber(h.minNoteOfBar);e&&!e.isRunning()&&e.run()}},h={ready:!1,tickIndex:-1,tickOfMinNote:-1,tickOfBar:-1,tickOfStack:-1,minNoteTickSize:-1,barTickSize:-1,stackTickSize:-1,barMinNoteSize:-1,barOfStack:-1,minNoteOfBar:-1,stackIndex:1},p=()=>{if(h.tickIndex+=1,!h.ready){const e=6e4/r.speed/r.beatNote*r.minBeatNote;h.minNoteTickSize=e/s.intervalTime,h.barTickSize=h.minNoteTickSize*r.barBeat*r.beatNote/r.minBeatNote,h.barMinNoteSize=h.barTickSize/h.minNoteTickSize,h.stackTickSize=h.barTickSize*s.barLength,h.ready=!0}h.tickOfMinNote=h.tickIndex%h.minNoteTickSize,h.tickOfBar=h.tickIndex%h.barTickSize,h.tickOfStack=h.tickIndex%h.stackTickSize,0===h.tickOfStack?(h.barOfStack=0,h.stackIndex=1-h.stackIndex):0===h.tickOfBar&&(h.barOfStack+=1),0===h.tickOfBar?h.minNoteOfBar=0:0===h.tickOfMinNote&&(h.minNoteOfBar+=1)},L=()=>{if(void 0!==s.interval)return clearInterval(s.interval),void(s.interval=void 0);s.interval=setInterval((()=>{S(),s.intervalRunTime+=s.intervalTime}),s.intervalTime)},S=()=>{p(),g(),k(),v()};return(0,i.sV)((()=>{f(),S(),r.ready=!0})),(e,s)=>((0,i.uX)(),(0,i.CE)("div",J,[(0,i.Lk)("div",U,[Y,(0,i.Lk)("div",Z,[(0,i.Lk)("div",{class:(0,n.C4)(["note-table",r.orderRevert?"bar-order-revert":""]),ref_key:"noteTable",ref:t,onClick:L},[(0,i.Lk)("div",ee,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.barStack0,((e,t)=>((0,i.uX)(),(0,i.Wv)((0,a.R1)(G),{item:e,speed:r.speed,ref_for:!0,ref:e=>l(t,e)},null,8,["item","speed"])))),256))]),(0,i.Lk)("div",te,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(r.barStack1,((e,t)=>((0,i.uX)(),(0,i.Wv)((0,a.R1)(G),{item:e,speed:r.speed,ref_for:!0,ref:e=>c(t,e)},null,8,["item","speed"])))),256))])],2)]),re])]))}};const ne=(0,v.A)(ie,[["__scopeId","data-v-86269e4c"]]);var ae=ne}}]);
//# sourceMappingURL=257.512b013e.js.map