{"version":3,"file":"js/719.3b345f21.js","mappings":"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","sources":["webpack://gutar/./src/page/guitar/chord.config.js","webpack://gutar/./src/page/guitar/random-note.js","webpack://gutar/./src/page/guitar/chord.vue","webpack://gutar/./src/page/guitar/chord.vue?becf","webpack://gutar/./src/page/guitar/tap-number.vue","webpack://gutar/./src/page/guitar/tap-number.vue?3ee0","webpack://gutar/./src/page/guitar/bar.vue","webpack://gutar/./src/page/guitar/bar.vue?02a9","webpack://gutar/./src/page/guitar/index.vue","webpack://gutar/./src/page/guitar/index.vue?da1f"],"sourcesContent":["module.exports = {\r\n    chordMap: {\r\n        \"C\": [{fret: 1, string: 2, finger: 1}, {fret: 2, string: 4, finger: 2}, {fret: 3, string: 5, finger: 3}],\r\n        \"D\": [{fret: 2, string: 1, finger: 1}, {fret: 2, string: 3, finger: 2}, {fret: 3, string: 2, finger: 3}],\r\n        \"E\": [{fret: 1, string: 3, finger: 1}, {fret: 2, string: 4, finger: 2}, {fret: 2, string: 5, finger: 3}],\r\n        \"F\": [{fret: 1, string: 1, finger: 1},{fret: 1, string: 2, finger: 1},{fret: 1, string: 6, finger: 1}, {fret: 2, string: 3, finger: 2}, {fret: 3, string: 5, finger: 3}, {fret: 3, string: 4, finger: 3}],\r\n        \"G\": [{fret: 2, string: 5, finger: 2}, {fret: 3, string: 6, finger: 3}, {fret: 3, string: 1, finger: 4}],\r\n        \"A\": [{fret: 2, string: 4, finger: 2}, {fret: 2, string: 3, finger: 3}, {fret: 2, string: 2, finger: 4}],\r\n        \"B\": [{fret: 2, string: 1, finger: 1},{fret: 2, string: 5, finger: 1},{fret: 2, string: 6, finger: 1}, {fret: 4, string: 2, finger: 2}, {fret: 4, string: 3, finger: 3}, {fret: 4, string: 4, finger: 4}],\r\n        \"Am\": [{fret: 1, string: 2, finger: 1}, {fret: 2, string: 3, finger: 2}, {fret: 2, string: 4, finger: 3}],\r\n        \"Dm\": [{fret: 2, string: 1, finger: 1}, {fret: 2, string: 3, finger: 2}, {fret: 3, string: 2, finger: 3}],\r\n        \"Em\": [{fret: 2, string: 4, finger: 1}, {fret: 2, string: 5, finger: 2}],\r\n    },\r\n    enabledChord:[\"C\",\"D\",\"E\",\"F\",\"G\",\"A\",\"B\",\"Am\",\"Dm\",\"Em\"],\r\n    pitchNames:[\r\n        [{number:3,topDot:1},{number:4,topDot:1},{number:4,topDot:1,half:1},{number:5,topDot:1}],\r\n        [{number:7},{number:1,topDot:1},{number:1,topDot:1,half:1},{number:2,half:1}],\r\n        [{number:5},{number:5,half:1},{number:6},{number:6,half:1}],\r\n        [{number:2},{number:2,half:1},{number:3},{number:4}],\r\n        [{number:6,bottomDot:1},{number:6,bottomDot:1,half:1},{number:7,bottomDot:1},{number:1}],\r\n        [{number:3,bottomDot:1},{number:4,bottomDot:1},{number:4,bottomDot:1,half:1},{number:5,bottomDot:1}]\r\n    ]\r\n}\r\n","import chordConfig from \"@/page/guitar/chord.config\";\r\n\r\nlet keyIndex = 0;\r\nconst getNoteItemKey = (type) => {\r\n    keyIndex++;\r\n    if (type === undefined) type = 'NoteItem';\r\n    return `${type}_${keyIndex}`\r\n}\r\nconst getRandomBarArr = ({barLength, barBeat, beatNote, minBeatNote, maxFret, noteRate}) => {\r\n    let newStack = [];\r\n    for (let i = 0; i < barLength; i++) {\r\n        let beatNoteStack = [];\r\n        //小节剩余的拍子\r\n        let leftNote = barBeat * beatNote;\r\n        let barBeatIndex = 0;\r\n        //最快的拍子\r\n        let maxBarBeatIndex = barBeat * beatNote / minBeatNote;\r\n        //小节拍子\r\n        let barNoteSize = 0;\r\n        //需要弹奏的音符数量\r\n        let fretStringSize = 0;\r\n        while (barBeatIndex < maxBarBeatIndex) {\r\n            const noteSize = barBeatIndex * minBeatNote;\r\n            if (barNoteSize > noteSize) {\r\n                if (noteSize % beatNote === 0) {\r\n                    //在拍子上补-1表示休止符\r\n                    beatNoteStack.push(-1);\r\n                } else {\r\n                    //不在拍子上补\r\n                    beatNoteStack.push(0);\r\n                }\r\n            } else {\r\n                //获取随机拍子\r\n                let note = getRandomNote(noteRate);\r\n                if (note <= leftNote) {\r\n                    leftNote -= note;\r\n                } else {\r\n                    note = leftNote;\r\n                    leftNote = 0;\r\n                }\r\n                beatNoteStack.push(note);\r\n                fretStringSize += 1;\r\n                barNoteSize += note;\r\n            }\r\n            barBeatIndex++;\r\n        }\r\n        //获取随机弹奏位置\r\n        let randomFretStringArr = getRandomFretString(fretStringSize, maxFret);\r\n        //该小节\r\n        const key = getNoteItemKey('barKey');\r\n        let barItem = {\r\n            _key: key,\r\n            noteList: []\r\n        };\r\n        let randomFretStringIndex = 0;\r\n        for (let i = 0; i < beatNoteStack.length; i++) {\r\n            let note = beatNoteStack[i];\r\n            const key = getNoteItemKey('noteItem');\r\n            if (note > 0) {\r\n                let fretString = randomFretStringArr[randomFretStringIndex];\r\n                let pitchName = chordConfig.pitchNames[fretString.string - 1][fretString.fret];\r\n                barItem.noteList.push({\r\n                    _key: key,\r\n                    note: note,\r\n                    ...fretString,\r\n                    ...pitchName\r\n                })\r\n                randomFretStringIndex++;\r\n            } else {\r\n                barItem.noteList.push({\r\n                    _key: key,\r\n                    note: note,\r\n                });\r\n            }\r\n        }\r\n        newStack.push(barItem);\r\n    }\r\n    return newStack;\r\n}\r\nconst getRandomFretString = (size, maxFret) => {\r\n    let result = [];\r\n    let chordLength = chordConfig.enabledChord.length;\r\n    let chordContinueSize = 0;\r\n    let randomChordName;\r\n    for (let i = 0; i < size; i++) {\r\n        let beginChord = false;\r\n        if (chordContinueSize < 1) {\r\n            let useChord = (i === 0 || Math.random() > 0.5) && (size - i > 1);\r\n            if (useChord) {\r\n                let randomChordIndex = Math.floor(Math.random() * chordLength);\r\n                beginChord = true;\r\n                randomChordName = chordConfig.enabledChord[randomChordIndex];\r\n                let chordItemLength = chordConfig.chordMap[randomChordName].length;\r\n                chordContinueSize = 2 + Math.floor(Math.random() * (chordItemLength - 1));\r\n            } else {\r\n                result.push({\r\n                    fret: Math.floor(Math.random() * (maxFret + 1)),\r\n                    string: Math.ceil(Math.random() * 6),\r\n                })\r\n            }\r\n        }\r\n        if (chordContinueSize > 0) {\r\n            let chord = chordConfig.chordMap[randomChordName];\r\n            let chordItemLength = chordConfig.chordMap[randomChordName].length;\r\n            let chordItemIndex = Math.floor(Math.random() * chordItemLength);\r\n            let chordItem = chord[chordItemIndex];\r\n            result.push({\r\n                beginChord: beginChord,\r\n                chordName: randomChordName,\r\n                fret: chordItem.fret,\r\n                string: chordItem.string\r\n            })\r\n            chordContinueSize--;\r\n        }\r\n    }\r\n    return result;\r\n}\r\n\r\nconst getRandomNote = (noteRate) => {\r\n    let maxIndex = 0;\r\n    let maxRate = 0;\r\n    for (let index = 0; index < noteRate.length; index++) {\r\n        let rate = noteRate[index] * Math.random()\r\n        if (rate > maxRate) {\r\n            maxRate = rate;\r\n            maxIndex = index;\r\n        }\r\n    }\r\n    let note = 1 / (1 << maxIndex)\r\n    return note;\r\n}\r\nexport default {\r\n    getRandomBarArr\r\n}\r\n","<template>\r\n  <div class=\"chord-box\">\r\n    <div class=\"chord-name\">\r\n      {{ name }}\r\n    </div>\r\n    <div class=\"chord-content\">\r\n      <div class=\"chord-sign\"></div>\r\n      <div class=\"chord-table\">\r\n        <div class=\"chord-fret\" v-for=\"fret in state.maxFret\">\r\n          <div class=\"chord-string\" v-for=\"string in 6\" :class=\"string === 6 ? 'chord-string-last' : '' \">\r\n            <div class=\"string-dot\" v-if=\"state.fretInfo[fret] && state.fretInfo[fret][7-string]!==undefined\"></div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport {defineProps, onMounted, reactive} from \"vue\";\r\nimport {chordMap} from \"@/page/guitar/chord.config\";\r\n\r\nconst state = reactive({\r\n  maxFret: 3,\r\n  fretInfo: {}\r\n})\r\n\r\nconst props = defineProps({\r\n  name: {\r\n    required: true,\r\n    type: String\r\n  }\r\n})\r\n\r\nconst init = () => {\r\n  const chordInfo = chordMap[props.name];\r\n  if (chordInfo === undefined) return;\r\n  let fretInfo = {};\r\n  let maxFret = 0;\r\n  for (let i = 0; i < chordInfo.length; i++) {\r\n    const fret = chordInfo[i].fret;\r\n    maxFret = fret > maxFret ? fret : maxFret;\r\n    const string = chordInfo[i].string;\r\n    const finger = chordInfo[i].finger;\r\n    if (fretInfo[fret] === undefined) {\r\n      fretInfo[fret] = {};\r\n    }\r\n    fretInfo[fret][string] = finger;\r\n  }\r\n  state.maxFret = maxFret < 3 ? 3 : maxFret;\r\n  state.fretInfo = fretInfo;\r\n}\r\n\r\ninit();\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.chord-box {\r\n  display: flex;\r\n  flex-direction: column;\r\n  float: left;\r\n\r\n  .chord-name {\r\n    text-align: center;\r\n  }\r\n}\r\n\r\n.chord-content {\r\n  display: flex;\r\n  flex-direction: column;\r\n\r\n  .chord-sign {\r\n    display: flex;\r\n  }\r\n\r\n  .chord-table {\r\n    border-bottom: 1px solid black;\r\n  }\r\n}\r\n\r\n.chord-fret {\r\n  display: flex;\r\n  border-top: 1px solid black;\r\n\r\n  .chord-string {\r\n    width: 6px;\r\n    height: 7px;\r\n    border-left: 1px solid black;\r\n  }\r\n\r\n  .chord-string-last {\r\n    width: 0;\r\n  }\r\n\r\n  .string-dot {\r\n    width: 100%;\r\n    height: 100%;\r\n    display: flex;\r\n    flex-direction: column;\r\n    justify-content: center;\r\n\r\n    &:before {\r\n      content: '';\r\n      width: 4px;\r\n      height: 4px;\r\n      background-color: black;\r\n      border-radius: 100%;\r\n      float: left;\r\n      margin-left: -2px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./chord.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./chord.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./chord.vue?vue&type=style&index=0&id=2eb72a0d&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2eb72a0d\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"item\">\r\n    <div class=\"item-animation\">\r\n      <div v-if=\"state.start && state.result===undefined\"\r\n           class=\"item-circle\"\r\n           :class=\"state.isPause?'animation-pause':'animation-running'\"\r\n           :style=\"{ 'animation': `circle-close ${props.duration/1000}s linear` }\">\r\n      </div>\r\n      <div v-if=\"state.result!==undefined\"\r\n           :style=\"`width:${state.scoreBoxSize}px;height:${state.scoreBoxSize}px;margin-top:${1-state.scoreBoxSize/2}px`\"\r\n           class=\"item-result\"\r\n           :class=\"`item-result-${state.result}`\">\r\n        <span class=\"score-name\">{{ state.result }}</span>\r\n      </div>\r\n    </div>\r\n    <span :class=\"state.result!==undefined?`number-${state.result}`:''\">{{\r\n        value\r\n      }}</span>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport {defineProps, onMounted, reactive} from \"vue\";\r\n\r\n/**\r\n * good : 节奏 +-0.5\r\n * great : 节奏 +-0.5 准音调\r\n * perfect : 节奏 +-0.1 准音调\r\n */\r\nconst scoreName = ['miss', 'good', 'great', 'perfect']\r\nconst beginTime = new Date().getTime();\r\n\r\nconst state = reactive({\r\n  result: undefined,\r\n  continueTime: 0,\r\n  scoreBoxSize: 0,\r\n  isPause: true,\r\n  start: false\r\n});\r\n\r\nlet endMethod = () => {\r\n}\r\n\r\nconst props = defineProps({\r\n  value: {\r\n    required: true,\r\n    type: Number\r\n  },\r\n  duration: {\r\n    required: true,\r\n    type: Number\r\n  },\r\n  itemKey: {\r\n    required: true,\r\n    type: String\r\n  }\r\n})\r\n\r\nconst setScore = (score) => {\r\n  if (state.isPause || state.result !== undefined) return;\r\n  state.continueTime = new Date().getTime() - beginTime;\r\n  const rate = state.continueTime / props.duration;\r\n  const left = rate >= 1 ? 0 : 1 - rate;\r\n  const boxSize = 20 + Math.floor(20 * left);\r\n  state.scoreBoxSize = boxSize + boxSize % 2;\r\n  state.result = scoreName[score];\r\n  endMethod();\r\n}\r\n\r\nlet setScoreTimeOut;\r\nlet setScoreTime = 0;\r\nlet setScoreTimeStamp = 0;\r\nconst run = () => {\r\n  state.start = true;\r\n  if (state.isPause) {\r\n    state.isPause = false;\r\n    //开始\r\n    setScoreTimeStamp = new Date().getTime();\r\n    setScoreTimeOut = setTimeout(() => {\r\n      setScore(0);\r\n    }, props.duration - setScoreTime);\r\n  }\r\n}\r\n\r\nconst pause = () => {\r\n  if (!state.isPause) {\r\n    state.isPause = true;\r\n    if (setScoreTimeOut !== undefined) {\r\n      clearTimeout(setScoreTimeOut);\r\n    }\r\n    setScoreTime = new Date().getTime() - setScoreTimeStamp;\r\n  }\r\n}\r\n\r\nconst togglePause = () => {\r\n  if (state.isPause) {\r\n    run();\r\n  } else {\r\n    pause();\r\n  }\r\n}\r\n\r\nconst isRunning = () => {\r\n  return !state.isPause;\r\n}\r\n\r\nconst setEndMethod = (m) => {\r\n  endMethod = m;\r\n}\r\n\r\nconst getItemKey = () => {\r\n  return props.itemKey;\r\n}\r\n\r\ndefineExpose({\r\n  setScore,\r\n  isRunning,\r\n  run,\r\n  pause,\r\n  togglePause,\r\n  setEndMethod,\r\n  getItemKey\r\n})\r\n\r\n</script>\r\n<style lang=\"less\">\r\n@keyframes circle-close {\r\n  0% {\r\n    border: 1px solid #3f3f3f;\r\n    width: 40px;\r\n    height: 40px;\r\n    margin-top: -19px;\r\n  }\r\n  100% {\r\n    border: 1px solid #3f3f3f;\r\n    width: 20px;\r\n    height: 20px;\r\n    margin-top: -9px;\r\n  }\r\n}\r\n\r\n@keyframes score-show {\r\n  0% {\r\n    opacity: 100%;\r\n  }\r\n  100% {\r\n    opacity: 0;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"less\" scoped>\r\n.animation-running {\r\n  animation-play-state: running !important;\r\n}\r\n\r\n.animation-pause {\r\n  animation-play-state: paused !important;\r\n}\r\n\r\n.item {\r\n  height: 2px;\r\n  margin: 10px 0;\r\n  text-align: center;\r\n  line-height: 2px;\r\n}\r\n\r\n.item-animation {\r\n  width: 100%;\r\n  height: 0;\r\n  padding: 0;\r\n  margin: 0;\r\n  display: flex;\r\n  justify-content: center;\r\n\r\n  .item-circle {\r\n    border-radius: 100%;\r\n    align-items: center;\r\n    flex-shrink: 0;\r\n  }\r\n}\r\n\r\n.item-result {\r\n  opacity: 0;\r\n  border-radius: 100%;\r\n  animation: score-show 0.8s linear;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  flex-shrink: 0;\r\n\r\n  .score-name {\r\n    line-height: 12px;\r\n    color: white;\r\n    transform: scale(0.6);\r\n    margin-left: -3px;\r\n  }\r\n}\r\n\r\n.item-result-miss {\r\n  font-size: 12px;\r\n  background-color: #afb6b6;\r\n}\r\n\r\n.item-result-good {\r\n  font-size: 13px;\r\n  background-color: #c6ffff;\r\n}\r\n\r\n.item-result-great {\r\n  font-size: 14px;\r\n  background-color: #76ffff;\r\n}\r\n\r\n.item-result-perfect {\r\n  font-size: 12px;\r\n  background-color: #00ffff;\r\n}\r\n\r\n.number-miss {\r\n  color: #afb6b6;\r\n}\r\n\r\n.number-good {\r\n  color: #008bda;\r\n}\r\n\r\n.number-great {\r\n  color: #008bda;\r\n}\r\n\r\n.number-perfect {\r\n  color: #008bda;\r\n}\r\n</style>\r\n","import script from \"./tap-number.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./tap-number.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./tap-number.vue?vue&type=style&index=0&id=7f44a16a&lang=less\"\nimport \"./tap-number.vue?vue&type=style&index=1&id=7f44a16a&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-7f44a16a\"]])\n\nexport default __exports__","<template>\r\n  <div class=\"bar-line\">\r\n    <div class=\"chord-line\">\r\n      <div class=\"note-item\"></div>\r\n      <template v-for=\"noteItem in props.item.noteList\">\r\n        <div class=\"note-item\">\r\n          <div class=\"chord-box\"\r\n               v-if=\"noteItem.beginChord\">\r\n            <chord :name=\"noteItem.chordName\"></chord>\r\n          </div>\r\n        </div>\r\n      </template>\r\n    </div>\r\n    <div class=\"bar-content\">\r\n      <div class=\"bar-start\">\r\n        <div class=\"bar-start-top\"></div>\r\n        <div class=\"bar-start-center\"></div>\r\n        <div class=\"bar-start-bottom\"></div>\r\n      </div>\r\n      <div>\r\n        <div class=\"string-line\">\r\n          <div class=\"note-item\">\r\n            <div>\r\n              <div class=\"note-tab\">\r\n                <span class=\"note-tab-text\">T</span>\r\n                <span class=\"note-tab-text\">A</span>\r\n                <span class=\"note-tab-text\">B</span>\r\n              </div>\r\n              <div class=\"note-string\" v-for=\"i in 6\"></div>\r\n            </div>\r\n          </div>\r\n          <template v-for=\"(noteItem,noteIndex) in props.item.noteList\" :key=\"noteItem._key\">\r\n            <div class=\"note-item\" :id=\"noteItem._key\" >\r\n              <div v-if=\"noteIndex===props.item.noteList.length-1\" class=\"note-tab note-tab-end\">\r\n              </div>\r\n              <div class=\"note-string\" v-for=\"i in 6\">\r\n                <TapNumber v-if=\"noteItem.string === i\"\r\n                           :duration=\"60000/props.speed\"\r\n                           :value=\"noteItem.fret\"\r\n                           :itemKey=\"noteItem._key\"\r\n                           :ref=\"el => setTapNumber(noteIndex,el)\"\r\n                ></TapNumber>\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n        <div class=\"number-line\">\r\n          <div class=\"note-item\"></div>\r\n          <template v-for=\"noteItem in props.item.noteList\">\r\n            <div class=\"note-item\">\r\n              <div class=\"number-box\">\r\n                <div class=\"number-dot\" :class=\"noteItem.topDot?'number-dot-show':''\"></div>\r\n                <div class=\"number-half\" :class=\"noteItem.half?'number-half-show':''\"><span\r\n                    class=\"note-number\">{{ noteItem.number }}</span></div>\r\n                <div class=\"number-dot\" :class=\"noteItem.bottomDot?'number-dot-show':''\"></div>\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script setup>\r\nimport {defineProps, defineExpose, onMounted, reactive} from \"vue\";\r\nimport Chord from \"@/page/guitar/chord.vue\";\r\nimport TapNumber from \"@/page/guitar/tap-number\";\r\n\r\nconst props = defineProps({\r\n  item: {\r\n    required: true\r\n  },\r\n  speed: {\r\n    required: true,\r\n    type: Number\r\n  }\r\n})\r\n\r\nconst tapNumberArr = {};\r\nconst setTapNumber = (noteIndex,ref)=>{\r\n  tapNumberArr[noteIndex] = ref;\r\n}\r\n\r\n\r\nconst getTapNumber = (noteIndex)=>{\r\n  return tapNumberArr[noteIndex];\r\n}\r\n\r\ndefineExpose({\r\n  getTapNumber\r\n});\r\n</script>\r\n<style lang=\"less\" scoped>\r\n\r\n.bar-content {\r\n  display: flex;\r\n}\r\n\r\n.bar-line {\r\n  width: 100%;\r\n  display: flex;\r\n  padding-top: 10px;\r\n  padding-bottom: 20px;\r\n  flex-direction: column;\r\n}\r\n\r\n.chord-line {\r\n  display: flex;\r\n}\r\n\r\n.string-line {\r\n  width: 100%;\r\n  display: flex;\r\n}\r\n\r\n.number-line {\r\n  width: 100%;\r\n  display: flex;\r\n  border-left: 2px solid black;\r\n  padding-top: 20px;\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.note-item {\r\n  width: 40px;\r\n  text-align: center;\r\n\r\n  .note-string {\r\n    display: block;\r\n    width: 100%;\r\n    margin-top: 10px;\r\n    height: 2px;\r\n    background-color: black;\r\n    line-height: 0px;\r\n  }\r\n\r\n  .note-number {\r\n    font-weight: lighter;\r\n    margin-left: -5px;\r\n  }\r\n}\r\n\r\n.number-top-dot:before {\r\n  width: 4px;\r\n  height: 4px;\r\n  border-radius: 4px;\r\n  background-color: black;\r\n}\r\n\r\n.number-bottom-dot:after {\r\n  width: 4px;\r\n  height: 4px;\r\n  border-radius: 4px;\r\n  background-color: black;\r\n}\r\n\r\n.number-box {\r\n  width: 100%;\r\n  display: flex;\r\n  flex-direction: column;\r\n  text-align: center;\r\n  height: 30px;\r\n}\r\n\r\n.number-dot {\r\n  width: 3px;\r\n  height: 3px;\r\n  border-radius: 3px;\r\n  background-color: transparent;\r\n  margin: 0 auto;\r\n}\r\n\r\n.number-dot-show {\r\n  background-color: #464646;\r\n}\r\n\r\n.note-tab {\r\n  height: 100%;\r\n  border-left: 2px solid black;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: space-around;\r\n  float: left;\r\n}\r\n\r\n.note-tab-end {\r\n  border-left: none;\r\n  border-right: 2px solid black;\r\n  float: right;\r\n}\r\n\r\n.note-tab-text {\r\n  font-size: 20px;\r\n  line-height: 20px;\r\n  display: inline-block;\r\n}\r\n\r\n.number-half:before {\r\n  content: '#';\r\n  width: 0;\r\n  margin-left: 5px;\r\n  float: left;\r\n  font-weight: lighter;\r\n  display: inline-block;\r\n  color: transparent;\r\n}\r\n\r\n.number-half-show:before {\r\n  color: black;\r\n}\r\n\r\n.bar-start {\r\n  display: flex;\r\n  flex-direction: column;\r\n  float: left;\r\n  width: 4px;\r\n\r\n  .bar-start-top {\r\n    display: inline-block;\r\n    height: 6px;\r\n    width: 8px;\r\n    background-color: black;\r\n    border-radius: 0 0 200% 0;\r\n\r\n    &:before {\r\n      content: '';\r\n      display: inline-block;\r\n      height: 5px;\r\n      width: 9px;\r\n      background-color: white;\r\n      border-radius: 0 0 200% 0;\r\n      float: left;\r\n      margin-left: -1px;\r\n      margin-top: -1px;\r\n    }\r\n  }\r\n\r\n  .bar-start-center {\r\n    flex: 1;\r\n    border-left: 3px solid black;\r\n  }\r\n\r\n  .bar-start-bottom {\r\n    display: inline-block;\r\n    height: 6px;\r\n    width: 8px;\r\n    background-color: black;\r\n    border-radius: 0 200% 0 0;\r\n\r\n    &:before {\r\n      margin-top: 3px;\r\n      content: '';\r\n      display: inline-block;\r\n      height: 5px;\r\n      width: 9px;\r\n      background-color: white;\r\n      border-radius: 0 200% 0 0;\r\n      float: left;\r\n      margin-left: -1px;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./bar.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./bar.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./bar.vue?vue&type=style&index=0&id=1ef35160&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-1ef35160\"]])\n\nexport default __exports__","<template>\r\n  <div style=\"height: 100%;padding: 0 10px\">\r\n    <div style=\"display: flex;flex-direction: column;height: 100%;\">\r\n      <div>\r\n        <div class=\"page-head\">\r\n          <div class=\"page-title\">{{ state.title }}</div>\r\n          <div class=\"page-info\">\r\n            <div class=\"page-info-line\">1 = C {{ state.barBeat }}/{{ Math.floor(1 / state.beatNote) }}</div>\r\n            <div class=\"page-info-line\">♪ = {{ state.speed }}</div>\r\n            <div class=\"page-info-line\">Capo = 1</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div class=\"note-page\">\r\n        <div class=\"note-table\" ref=\"noteTable\" @click=\"toggleInterval\">\r\n          <div class=\"bar-group\">\r\n            <Bar v-for=\"(barItem,barIndex) in state.barStack0\" :item=\"barItem\" :speed=\"state.speed\"\r\n                 :ref=\"el=>setBarRef0(barIndex,el)\"></Bar>\r\n          </div>\r\n          <div class=\"bar-group\">\r\n            <Bar v-for=\"(barItem,barIndex) in state.barStack1\" :item=\"barItem\" :speed=\"state.speed\"\r\n                 :ref=\"el=>setBarRef1(barIndex,el)\">\r\n\r\n            </Bar>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div style=\"width: 100%\">\r\n        <div style=\"background-color: white;height: 10vh;width: 100%\">\r\n          <!--   FOOT     -->\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport randomNoteUtil from \"@/page/guitar/random-note\";\r\nimport {onMounted, reactive, ref, nextTick} from \"vue\";\r\nimport Bar from '@/page/guitar/bar';\r\n\r\nconst noteTable = ref();\r\n\r\nconst state = reactive({\r\n  ready: false,\r\n  //标题\r\n  title: 'EMO',\r\n  //速度\r\n  speed: 60,\r\n  //每小节4拍\r\n  barBeat: 4,\r\n  //4分之1音符为1拍\r\n  beatNote: 1 / 4,\r\n  //最小音符\r\n  minBeatNote: 1 / 8,\r\n  //音符出现权重 全音符、2分之1音符、4分之1音符，8分之一音符\r\n  noteRate: [2, 2, 6, 3],\r\n  //最大品位\r\n  maxFret: 3,\r\n  //第一谱子\r\n  barStack0: [],\r\n  //第二谱子\r\n  barStack1: []\r\n});\r\n\r\nconst data = {\r\n  //运行时间\r\n  intervalRunTime: 0,\r\n  //interval\r\n  interval: undefined,\r\n  //stack的长度\r\n  barLength: 10,\r\n  //每帧时间\r\n  intervalTime: 5,\r\n  //第一小节组\r\n  barRef0: {},\r\n  //第二小节组\r\n  barRef1: {},\r\n  //运行中的tapNum\r\n  runningTapNum: {}\r\n}\r\n\r\nconst setBarRef0 = (index, ref) => {\r\n  data.barRef0[index] = ref;\r\n}\r\n\r\nconst setBarRef1 = (index, ref) => {\r\n  data.barRef1[index] = ref;\r\n}\r\n\r\nconst pushStack = () => {\r\n  let newStack = randomNoteUtil.getRandomBarArr({\r\n    barLength: data.barLength,\r\n    barBeat: state.barBeat,\r\n    beatNote: state.beatNote,\r\n    minBeatNote: state.minBeatNote,\r\n    maxFret: state.maxFret,\r\n    noteRate: state.noteRate\r\n  });\r\n  if (tickInfo.stackIndex === 1) {\r\n    state.barStack0 = newStack;\r\n  }\r\n  if (tickInfo.stackIndex === 0) {\r\n    state.barStack1 = newStack;\r\n  }\r\n}\r\n\r\nconst noteTickEvent = () => {\r\n  if (!state.ready || tickInfo.tickOfStack === tickInfo.barTickSize) {\r\n    pushStack();\r\n  }\r\n}\r\n\r\nconst animationTickEvent = () => {\r\n  //等待一小节\r\n  if (tickInfo.tickIndex < tickInfo.barTickSize) return;\r\n  const fistBarGroup = noteTable.value.children[0];\r\n  const secondBarGroup = noteTable.value.children[1];\r\n  const animationIndex = tickInfo.tickOfStack >= tickInfo.barTickSize\r\n      ? tickInfo.tickOfStack - tickInfo.barTickSize : (data.barLength - 1) * tickInfo.barTickSize + tickInfo.tickOfStack;\r\n  const animationTotalSize = tickInfo.stackTickSize;\r\n\r\n  const orderRevert = tickInfo.stackIndex === 0 && tickInfo.barOfStack === 0\r\n      || tickInfo.stackIndex === 1 && tickInfo.barOfStack > 0;\r\n\r\n  if (!orderRevert) {\r\n    let marginSize = -fistBarGroup.clientHeight * animationIndex / animationTotalSize;\r\n    fistBarGroup.style = `margin-top:${marginSize}px`;\r\n    noteTable.value.style = 'flex-direction: column;';\r\n  } else {\r\n    let beginSize = fistBarGroup.clientHeight + secondBarGroup.clientHeight - noteTable.value.clientHeight;\r\n    let marginSize = secondBarGroup.clientHeight * animationIndex / animationTotalSize - beginSize;\r\n    fistBarGroup.style = `margin-bottom:${marginSize}px`;\r\n    noteTable.value.style = 'flex-direction: column-reverse;';\r\n  }\r\n}\r\n\r\nconst runningNoteTickEvent = () => {\r\n  if (tickInfo.tickOfMinNote === 1) {\r\n    const noteRef = tickInfo.stackIndex === 0\r\n        ? data.barRef0[tickInfo.barOfStack]?.getTapNumber(tickInfo.minNoteOfBar)\r\n        : data.barRef1[tickInfo.barOfStack]?.getTapNumber(tickInfo.minNoteOfBar);\r\n    if (noteRef && !noteRef.isRunning()) {\r\n      noteRef.run();\r\n      const itemKey = noteRef.getItemKey();\r\n      data.runningTapNum[itemKey] = noteRef;\r\n      noteRef.setEndMethod(() => {\r\n        delete data.runningTapNum[itemKey];\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\n//节拍点信息\r\nconst tickInfo = {\r\n  ready: false,\r\n  //tick序号\r\n  tickIndex: -1,\r\n  //minNote的tick序号\r\n  tickOfMinNote: -1,\r\n  //bar的tick序号\r\n  tickOfBar: -1,\r\n  //stack的tick序号\r\n  tickOfStack: -1,\r\n  //最小音符持续一次的tick次数\r\n  minNoteTickSize: -1,\r\n  //小节持续一次的tick次数\r\n  barTickSize: -1,\r\n  //一次stack的tick次数\r\n  stackTickSize: -1,\r\n  //小节的最小音符数\r\n  barMinNoteSize: -1,\r\n  //bar索引\r\n  barOfStack: -1,\r\n  //minNote索引\r\n  minNoteOfBar: -1,\r\n  //弹奏中的谱子\r\n  stackIndex: 1,\r\n}\r\nconst recordTickInfo = () => {\r\n  tickInfo.tickIndex += 1;\r\n  if (!tickInfo.ready) {\r\n    const minNoteTime = 60000 / state.speed / state.beatNote * state.minBeatNote;\r\n    tickInfo.minNoteTickSize = minNoteTime / data.intervalTime;\r\n    tickInfo.barTickSize = tickInfo.minNoteTickSize * state.barBeat * state.beatNote / state.minBeatNote;\r\n    tickInfo.barMinNoteSize = tickInfo.barTickSize / tickInfo.minNoteTickSize;\r\n    tickInfo.stackTickSize = tickInfo.barTickSize * data.barLength;\r\n    tickInfo.ready = true;\r\n  }\r\n  tickInfo.tickOfMinNote = tickInfo.tickIndex % tickInfo.minNoteTickSize;\r\n  tickInfo.tickOfBar = tickInfo.tickIndex % tickInfo.barTickSize;\r\n  tickInfo.tickOfStack = tickInfo.tickIndex % tickInfo.stackTickSize;\r\n  if (tickInfo.tickOfStack === 0) {\r\n    tickInfo.barOfStack = 0;\r\n    tickInfo.stackIndex = 1 - tickInfo.stackIndex;\r\n  } else if (tickInfo.tickOfBar === 0) {\r\n    tickInfo.barOfStack += 1;\r\n  }\r\n  if (tickInfo.tickOfBar === 0) {\r\n    tickInfo.minNoteOfBar = 0;\r\n  } else if (tickInfo.tickOfMinNote === 0) {\r\n    tickInfo.minNoteOfBar += 1;\r\n  }\r\n}\r\n\r\nconst toggleInterval = () => {\r\n  if (data.interval !== undefined) {\r\n    clearInterval(data.interval);\r\n    data.interval = undefined;\r\n    //暂停\r\n    Object.keys(data.runningTapNum).forEach((itemKey) => {\r\n      data.runningTapNum[itemKey].pause();\r\n    });\r\n    return;\r\n  }\r\n\r\n  //恢复\r\n  Object.keys(data.runningTapNum).forEach((itemKey) => {\r\n    data.runningTapNum[itemKey].run();\r\n  });\r\n  data.interval = setInterval(() => {\r\n    tickEvent();\r\n    data.intervalRunTime += data.intervalTime;\r\n  }, data.intervalTime);\r\n}\r\n\r\nconst tickEvent = () => {\r\n  recordTickInfo();\r\n  noteTickEvent();\r\n  animationTickEvent();\r\n  runningNoteTickEvent();\r\n}\r\n\r\nonMounted(() => {\r\n  //开始时调用一次tick初始化数据\r\n  pushStack();\r\n  tickEvent();\r\n  state.ready = true;\r\n})\r\n\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.note-page {\r\n  flex: auto;\r\n  overflow: hidden;\r\n  display: flex;\r\n  justify-content: center;\r\n  margin:0 auto;\r\n}\r\n\r\n.note-table {\r\n  display: flex;\r\n  flex-direction: column;\r\n}\r\n\r\n.bar-group {\r\n  flex-shrink: 0;\r\n}\r\n\r\n.page-head {\r\n  background-color: white;\r\n  min-height: 10vh;\r\n  padding: 15px 0;\r\n  .page-title{\r\n    text-align: center;\r\n    font-size: 18px;\r\n  }\r\n  .page-info-line{\r\n    text-align: left;\r\n    font-size: 12px;\r\n    line-height: 15px;\r\n  }\r\n}\r\n\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=c2cc5046&lang=less&scoped=true\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-c2cc5046\"]])\n\nexport default __exports__"],"names":["module","exports","chordMap","fret","string","finger","enabledChord","pitchNames","number","topDot","half","bottomDot","keyIndex","getNoteItemKey","type","undefined","getRandomBarArr","barLength","barBeat","beatNote","minBeatNote","maxFret","noteRate","newStack","i","beatNoteStack","leftNote","barBeatIndex","maxBarBeatIndex","barNoteSize","fretStringSize","noteSize","push","note","getRandomNote","randomFretStringArr","getRandomFretString","key","barItem","_key","noteList","randomFretStringIndex","length","fretString","pitchName","chordConfig","size","randomChordName","result","chordLength","chordContinueSize","beginChord","useChord","Math","random","randomChordIndex","floor","chordItemLength","ceil","chord","chordItemIndex","chordItem","chordName","maxIndex","maxRate","index","rate","state","reactive","fretInfo","props","__props","init","chordInfo","name","__exports__","scoreName","beginTime","Date","getTime","continueTime","scoreBoxSize","isPause","start","endMethod","setScore","score","duration","left","boxSize","setScoreTimeOut","setScoreTime","setScoreTimeStamp","run","setTimeout","pause","clearTimeout","togglePause","isRunning","setEndMethod","m","getItemKey","itemKey","__expose","tapNumberArr","setTapNumber","noteIndex","ref","getTapNumber","noteTable","ready","title","speed","barStack0","barStack1","data","intervalRunTime","interval","intervalTime","barRef0","barRef1","runningTapNum","setBarRef0","setBarRef1","pushStack","randomNoteUtil","tickInfo","stackIndex","noteTickEvent","tickOfStack","barTickSize","animationTickEvent","tickIndex","fistBarGroup","value","children","secondBarGroup","animationIndex","animationTotalSize","stackTickSize","orderRevert","barOfStack","beginSize","clientHeight","marginSize","style","runningNoteTickEvent","tickOfMinNote","noteRef","minNoteOfBar","tickOfBar","minNoteTickSize","barMinNoteSize","recordTickInfo","minNoteTime","toggleInterval","clearInterval","Object","keys","forEach","setInterval","tickEvent","onMounted"],"sourceRoot":""}